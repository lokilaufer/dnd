(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function r(e,t,r){return(t=l(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return o(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(t){var r=function(t){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(r)?r:r+""}var c=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state=this.loadState()||{todo:["Покормить кота","Сделать DnD проект","Купить продукты"],"in-progress":["Пишу код","Исправляю баги"],done:["Выпить кофе","Посмотреть урок"]},this.draggedCard=null,this.draggedCardData=null,this.placeholder=null,this.init()},o=[{key:"loadState",value:function(){try{var e=localStorage.getItem("trello-state");return e?JSON.parse(e):null}catch(e){return null}}},{key:"saveState",value:function(){try{localStorage.setItem("trello-state",JSON.stringify(this.state))}catch(e){console.error("Failed to save state to localStorage:",e)}}},{key:"init",value:function(){this.renderBoard(),this.setupEventListeners()}},{key:"renderBoard",value:function(){for(var e=this,t=function(){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,l=[],c=!0,s=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw a}}return l}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(n[r],2),o=t[0],i=t[1],l=document.querySelector('[data-column="'.concat(o,'"] .cards-container'));if(!l)return 1;l.innerHTML="",i.forEach(function(t){var r=e.createCardElement(t,o);l.append(r)})},r=0,n=Object.entries(this.state);r<n.length;r++)t()}},{key:"createCardElement",value:function(e,t){var r=document.createElement("div");r.className="card",r.setAttribute("draggable","true"),r.setAttribute("data-column",t),r.setAttribute("data-text",e);var n=document.createElement("span");n.className="card-text",n.textContent=e;var a=document.createElement("button");return a.className="delete-btn",a.title="Удалить карточку",a.innerHTML="×",r.append(n),r.append(a),r.addEventListener("dragstart",this.handleDragStart.bind(this)),r.addEventListener("dragend",this.handleDragEnd.bind(this)),r}},{key:"setupEventListeners",value:function(){var e=this;document.querySelectorAll(".add-card-btn").forEach(function(t){t.addEventListener("click",function(t){var r=t.target.closest(".column").dataset.column;e.addCard(r)})}),document.addEventListener("click",function(t){if(t.target.classList.contains("delete-btn")){var r=t.target.closest(".card");e.deleteCard(r)}}),document.addEventListener("dragover",function(t){t.preventDefault(),t.dataTransfer.dropEffect="move",e.handleDragOver(t)}),document.addEventListener("drop",function(t){t.preventDefault(),e.handleDrop(t)}),document.addEventListener("dragenter",function(e){e.preventDefault()}),document.addEventListener("dragleave",function(e){e.preventDefault()})}},{key:"handleDragStart",value:function(e){var t=e.target.closest(".card");if(t){this.draggedCard=t,this.draggedCardData={text:t.dataset.text,sourceColumn:t.dataset.column,element:t},t.classList.add("dragging"),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",JSON.stringify({text:t.dataset.text,sourceColumn:t.dataset.column}));var r=t.cloneNode(!0);r.style.width=t.offsetWidth+"px",e.dataTransfer.setDragImage(r,e.offsetX,e.offsetY),navigator.userAgent.includes("Firefox")&&e.dataTransfer.setData("text/plain",t.dataset.text)}}},{key:"handleDragEnd",value:function(e){var t=e.target.closest(".card");t&&t.classList.remove("dragging"),this.draggedCard=null,this.draggedCardData=null,this.removePlaceholder()}},{key:"handleDragOver",value:function(e){if(this.draggedCardData){var t=e.target.closest(".card, .cards-container");if(t){var r=t.classList.contains("cards-container")?t:t.parentNode;if(r.classList.contains("cards-container")){var a=e.clientY,o=n(r.querySelectorAll(".card:not(.dragging)"));if(this.removePlaceholder(),this.placeholder=document.createElement("div"),this.placeholder.className="placeholder",0===o.length)r.appendChild(this.placeholder);else{for(var i=!1,l=0;l<o.length;l++){var c=o[l].getBoundingClientRect();if(a<c.top+c.height/2){r.insertBefore(this.placeholder,o[l]),i=!0;break}}i||r.appendChild(this.placeholder)}}}}}},{key:"handleDrop",value:function(e){if(e.preventDefault(),this.draggedCardData){var a=e.target.closest(".card, .cards-container");if(a){var o=a.classList.contains("cards-container")?a:a.parentNode;if(o.classList.contains("cards-container")){for(var i=o.closest(".column").dataset.column,l=e.clientY,c=n(o.querySelectorAll(".card")),s=c.length,d=0;d<c.length;d++){var u=c[d].getBoundingClientRect();if(l<u.top+u.height/2){s=d;break}}var f=this.draggedCardData,h=f.text,g=f.sourceColumn;if(g===i&&this.state[g].findIndex(function(e){return e===h})===s)return void this.cleanup();var v=function(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?t(Object(a),!0).forEach(function(t){r(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},this.state);v[g]=v[g].filter(function(e){return e!==h}),v[i]=[].concat(n(v[i].slice(0,s)),[h],n(v[i].slice(s))),this.state=v,this.saveState(),this.cleanup(),this.renderBoard()}}}}},{key:"removePlaceholder",value:function(){this.placeholder&&this.placeholder.parentNode&&(this.placeholder.parentNode.removeChild(this.placeholder),this.placeholder=null)}},{key:"cleanup",value:function(){this.removePlaceholder(),this.draggedCard=null,this.draggedCardData=null,this.draggedCardText="",this.draggedColumn="",this.draggedElement=null,this.dragStartX=0,this.dragStartY=0,this.dragOffsetX=0,this.dragOffsetY=0,document.querySelectorAll(".card.dragging").forEach(function(e){e.classList.remove("dragging")}),document.querySelectorAll(".placeholder").forEach(function(e){return e.remove()})}},{key:"addCard",value:function(e){var t=prompt("Введите название карточки:");t&&t.trim()&&(this.state[e].push(t.trim()),this.saveState(),this.renderBoard())}},{key:"deleteCard",value:function(e){var t=e.dataset.column,r=e.dataset.text;this.state[t]=this.state[t].filter(function(e){return e!==r}),this.saveState(),this.renderBoard()}}],o&&i(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,o}();document.addEventListener("DOMContentLoaded",function(){new c})})();